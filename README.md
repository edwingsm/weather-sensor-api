# weather-sensor-api

## Reuirement Analysis
 Going through the requirment it was noit clear what the weather sensor mean it an outdoor unit or indoor unit
 <br>I made an assusmption it's an outdoor unit which can be instllaed any location

 ## Design Thoughts

 Sine `Time`plays an important role in data here. There was bit tug of war between in my thought should iu choose OffsetDateTime or UTC instant . Aftyer googing a bit and checking few psedo codes . I took descisn to use UTC 

 API's are desinged only to accept UTC time in ISO format, this is done to avoid conversion logic in backend <br> still for enity creation in Repsonse UTC time is converted back Zonetime to avoid confusion on client ( _*not sure is this a good approach*_)

### DB
As a POC thougt to use H2 in memory for DB , while designing schema 2 tables are used
- senors : for storing senso infromation 
- sensor_reading : for storing readings
`sensor ...1n....> sensor_reading` 

This might sound bit contersial I thought to use 2 unique constraints on senso table , 
- `Id`: Autogenerated 
- `tag` : Provided via API


### API
* `Open API` is used to document API documentation (not all DTOs are documented)
* `@ControllerAdive` for exception handling

### Testing
Even though there are test classes for all the classes written main focus was given to `SpringBootTest` and `@DataJpaTest`

`Jacoco` plugin will code coverage

## Mistakes Identified
- Currently, the persistence is case-sensitive , I came to realization very late.
- Some `JPQL` queries are not ideal without indexing database , might be adding `@Transactional(readOnly=true)` will improve performance on readonly functions

## What's missing
- Security ,I try to implement securty in the last . After enabling security APP start behave chaged
   - h2 console start to act weired after enabling security
  - Also unit tests/integration tests are missing security aspect , I tried to implement but failed seems like some test instrumentation issue

## What should I have done different
- I think there is code duplication which could have been avoided 
- Enable security Revisit testing
